We are using Kylin4.0.1 but it's not working properly with hudi we are facing java.lang.NullPointerException ERROR while building Kylin-Cube, 
I am building a cube in kylin, source tables are in hive saved in hudi parquet. It gives NullPointerException on second step. It works fine on simple tables that are not saved using hudi. Error stack is given below. Can you please help us in fixing this issue. Hudi jars are placed in kylin as well as in spark.

2022-06-21 08:20:59,365 DEBUG [pool-1-thread-1] cachesync.CachedCrudAssist : Reloading ProjectInstance from hdfs://127.0.0.1:9000/kylin/kylin_metadata/learn_kylin/job_tmp/68af66a7-75dc-463f-abc5-943ffe3204c0-01/meta/project 2022-06-21 08:20:59,368 DEBUG [pool-1-thread-1] cachesync.CachedCrudAssist : Loaded 1 ProjectInstance(s) out of 1 resource with 0 errors 2022-06-21 08:20:59,368 INFO [pool-1-thread-1] common.KylinConfig : Creating new manager instance of class org.apache.kylin.metadata.cachesync.Broadcaster 2022-06-21 08:20:59,368 DEBUG [pool-1-thread-1] cachesync.Broadcaster : 1 nodes in the cluster: [localhost:7070] 2022-06-21 08:20:59,368 INFO [pool-1-thread-1] common.KylinConfig : Creating new manager instance of class org.apache.kylin.metadata.model.DataModelManager 2022-06-21 08:20:59,368 INFO [pool-1-thread-1] common.KylinConfig : Creating new manager instance of class org.apache.kylin.metadata.TableMetadataManager 2022-06-21 08:20:59,368 DEBUG [pool-1-thread-1] cachesync.CachedCrudAssist : Reloading TableDesc from hdfs://127.0.0.1:9000/kylin/kylin_metadata/learn_kylin/job_tmp/68af66a7-75dc-463f-abc5-943ffe3204c0-01/meta/table 2022-06-21 08:20:59,375 DEBUG [pool-1-thread-1] cachesync.CachedCrudAssist : Loaded 2 TableDesc(s) out of 2 resource with 0 errors 2022-06-21 08:20:59,375 DEBUG [pool-1-thread-1] cachesync.CachedCrudAssist : Reloading TableExtDesc from hdfs://127.0.0.1:9000/kylin/kylin_metadata/learn_kylin/job_tmp/68af66a7-75dc-463f-abc5-943ffe3204c0-01/meta/table_exd 2022-06-21 08:20:59,379 DEBUG [pool-1-thread-1] cachesync.CachedCrudAssist : Loaded 2 TableExtDesc(s) out of 2 resource with 0 errors 2022-06-21 08:20:59,379 DEBUG [pool-1-thread-1] cachesync.CachedCrudAssist : Reloading ExternalFilterDesc from hdfs://127.0.0.1:9000/kylin/kylin_metadata/learn_kylin/job_tmp/68af66a7-75dc-463f-abc5-943ffe3204c0-01/meta/ext_filter 2022-06-21 08:20:59,379 DEBUG [pool-1-thread-1] cachesync.CachedCrudAssist : Loaded 0 ExternalFilterDesc(s) out of 0 resource with 0 errors 2022-06-21 08:20:59,379 DEBUG [pool-1-thread-1] cachesync.CachedCrudAssist : Reloading DataModelDesc from hdfs://127.0.0.1:9000/kylin/kylin_metadata/learn_kylin/job_tmp/68af66a7-75dc-463f-abc5-943ffe3204c0-01/meta/model_desc 2022-06-21 08:20:59,382 DEBUG [pool-1-thread-1] cachesync.CachedCrudAssist : Loaded 1 DataModelDesc(s) out of 1 resource with 0 errors 2022-06-21 08:20:59,383 DEBUG [pool-1-thread-1] cachesync.CachedCrudAssist : Loaded 1 CubeDesc(s) out of 1 resource with 0 errors 2022-06-21 08:20:59,383 DEBUG [pool-1-thread-1] cachesync.CachedCrudAssist : Loaded 1 CubeInstance(s) out of 1 resource with 0 errors 2022-06-21 08:20:59,392 INFO [pool-1-thread-1] job.CubeBuildJob : There are 0 cuboids to be built in segment 20210212024500_20220601000000. 2022-06-21 08:20:59,392 INFO [pool-1-thread-1] job.CubeBuildJob : Updating segment info 2022-06-21 08:20:59,398 INFO [pool-1-thread-1] job.CubeBuildJob : Building job takes 49 ms 2022-06-21 08:20:59,398 ERROR [pool-1-thread-1] application.SparkApplication : The spark job execute failed! java.lang.NullPointerException at org.apache.kylin.engine.spark.job.CubeBuildJob.doExecute(CubeBuildJob.java:204) at org.apache.kylin.engine.spark.application.SparkApplication.execute(SparkApplication.java:308) at org.apache.kylin.engine.spark.application.SparkApplication.execute(SparkApplication.java:94) at org.apache.spark.application.JobWorker$$anon$2.run(JobWorker.scala:55) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748) 2022-06-21 08:20:59,399 ERROR [pool-1-thread-1] application.JobMonitor : Job failed the 2 times. java.lang.RuntimeException: Error execute org.apache.kylin.engine.spark.job.CubeBuildJob at org.apache.kylin.engine.spark.application.SparkApplication.execute(SparkApplication.java:97) at org.apache.spark.application.JobWorker$$anon$2.run(JobWorker.scala:55) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:748) Caused by: java.lang.NullPointerException at org.apache.kylin.engine.spark.job.CubeBuildJob.doExecute(CubeBuildJob.java:204) at org.apache.kylin.engine.spark.application.SparkApplication.execute(SparkApplication.java:308) at org.apache.kylin.engine.spark.application.SparkApplication.execute(SparkApplication.java:94) ... 4 more 2022-06-21 08:20:59,399 INFO [pool-1-thread-1] autoheal.ExceptionTerminator : Reset spark.executor.memory=6144MB when retry. 2022-06-21 08:20:59,399 INFO [pool-1-thread-1] autoheal.ExceptionTerminator : Reset spark.executor.memoryOverhead=1228MB when retry.


